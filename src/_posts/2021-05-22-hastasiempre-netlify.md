---
title: بدرود نتلیفای
tags: نتلیفای میلینگ‌لیست ماتریکس
---
بعد از سالها استفاده از نتلیفای بالاخره زمان مهاجرت فرا رسید، البته به سرور خودم.

دیروز اول دیدگاه‌های خوانندگان را از سرور نتلیفای استخراج کردم (اسکریپت بیلدم اینکار را انجام می‌دهد) و سایت را لوکال ساختم و در سرور خودم کپی کردم (با scp). سپس مشخصات سرویس DNS سرویس‌دهنده‌ی سرور مجازی‌ام را در nic.ir وارد کردم. (پیش از این از سرویس DNS رایگان نتلیفای استفاده کرده بودم.) روی صفحه‌ی ادمین سرویس‌دهنده‌‌ام هم آی‌پی‌های سرور را به دامنه متصل کردم. بعد اول تنظیمات دامنه را از نتلیفای حذف کردم. تقریبا درجا سایت از کار افتاد. بعد خود سایت را از نتلیفای حذف کردم و بعد هم اکانتم را.

سایت همانطور که پیش‌بینی می‌کردم از کار افتاد. عجله‌ای نداشتم. تقریبا دو ساعتی طول کشید تا تغییرات از nic.ir به سایر بخش‌های اینترنت برسد. التبه این را امروز به کمک یک سرویس کوچک دیگر (که قصد بازنشسته کردنش را دارم) متوجه شدم. این سرویس کوچک در فواصل زمانی مشخص سرور را پینگ می‌کند و اگر جوابی نیامد ایمیل می‌زند که سرور داون است. وقتی هم که برگشت بالا مدت داون بودن را گزارش می‌کند. من از وب‌سرور nginx استفاده می‌کنم. یک بلاک جدید برای سایت اضافه کردم:

	server {
		listen 80;
		root /var/www/mehdix.ir;
		index index.html;
		server_name mehdix.ir;
		location / {
			try_files $uri $uri/ =404;
		}
	}
	
بعد از این هم با کمک certbot سرتیفیکیت‌های لازم برای https را ساختم:

	$ sudo certbot

و وب‌سرور را ریلود کردم:

	$ sudo nginx -s reload

انتشار سایت هم می‌شود یک بیلد:

	$ bundler exec jekyll build

 و یک کپی:

	$ scp -r _site mehdix.ir:/var/www/mehdix.ir;

حالا سایت روی سرور جدید است. همانطور که قبلا نوشتم تا اطلاع ثانوی کامنتدونی کار نمی‌کند. تا زمانی که آن را تعمیر کنم دو راه حل در نظر گرفته‌ام. یکی یک [کانال ماتریکس] است که ساخته‌ام. فعلا که خالی است اما پرسشی داشتید آنجا در خدمتم. فعلا پشه پر نمی‌زند البته. اگر اسم [ماتریکس] (بجز فیلم آن!) تا بحال به گوشتان نخورده نگاهی به آن بیندازید. ماتریکس یک پروتکل فدراتیو برای ارتباط امن سرتاسری است (End-to-End or e2e). یعنی سرور مرکزی ندارد و هرکس می‌تواند از یک سرور با سرورهای دیگر حرف بزند. اتاق مهدیکس که ساخته‌ام روی سرور شرکت المنت سازنده‌ی ماتریکس است. در تعریف ماتریکس هم بگویم که کل رویداد امسال [FOSDEM] به صورت آنلاین روی ماتریکس برگزار شد، به همراه ویدیو و صوت و چت و اموجی و مانند اینها.

راه دیگر گفتگو هم ایمیل است. اواخر بیش از همیشه به میلینگ‌لیست‌های علاقه پیدا کرده‌ام و در اندک اندک در تعداد بیشتری عضو می‌شوم. برای سایت مهدیکس هم یک میلینگ‌لیست ساخته‌م که در آن به روی همه‌ی شما باز است، البته اگر توان پنچه‌درانداختن با کلایننت‌های میل قراضه و وب‌میل‌های ضد راست به چپ در شما هست! اینباکس عمومی سایت مهدیکس دات آی‌آر در [این آدرس] در خدمت شماست. عضویت برای عموم آزاد است. پیام‌ها به صورت استاندارد روی سورس‌هات قابل مشاهده خواهند بود. ایمیل فقط می‌تواند متن باشد (html ریجکت می‌شود، با دلایل خوب). سایت متن راست به چپ را به درستی نماش می‌دهد (حمل بر خودپرستی نشود خودم تعمیرش کرده‌ام). امتحان بکنید شاید سبب خیری شد. 

شاید کنجکاو باشید که مزایای اینکار چیست؟ عرض می‌کنم. اول اینکه من از تغییرات ناگهانی در شرکت سرویس‌دهنده که دست برقضا میلیونها دلار هم سرمایه از سرمایه‌گذاران دریافت کرده و متعاقبا باید منافع آنها را تامین بکند رها هستم. فردا ایمیل نمی‌اید که داریم در سرویس مفتی را می‌بندیم بیا سایتت را ببند یا فلان و بهمان. دیگر اینکه لازم نیست یاد بگیرم نتلیفای چطور کار می‌کند. شاید بگویید خوب حالا مجبوری یاد بگیری nginx و کامنت‌دونی جدیدت و یا سایر ابزارها چطور کار می‌کنند. در جواب بگویم که ایرادی ندارد. ترجیح من اینست که کار با فناوری و ابزار کمتر و بنیادی‌تر را یادبگیرم که تا ده‌ها سال بکارم بیاید. دیگر اینکه حالا می‌توانم سایت را نه تنها روی http بلکه مثلا با [gemini] هم سرو بکنم. یا لاگ‌های وب‌سرورم را خودم بخوانم یا کامنت‌دونی خودم را هاست بکنم. منی که سرم برای این کارها درد می‌کند خوب برایم همین بهتر است.

خلاصه به این ترتیب پایان یک دوران رقم خورد و دوره‌ی جدیدی برای من شروع شد. دوره‌ای خلوت‌تر از گذشته اما عمیق‌تر.

[کانال ماتریکس]: https://app.element.io/#/room/#mehdix.ir:matrix.org
[ماتریکس]: https://matrix.org/
[FOSDEM]: https://fosdem.org/2021/
[این آدرس]: https://lists.sr.ht/~mehdix/public-inbox
[gemini]: https://gemini.circumlunar.space/
